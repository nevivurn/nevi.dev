<?xml version="1.0" encoding="utf-8" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 20010904//EN" "http://www.w3.org/TR/2001/REC-SVG-20010904/DTD/svg10.dtd"><svg xmlns="http://www.w3.org/2000/svg" width="654" height="421" xmlns:xlink="http://www.w3.org/1999/xlink"><source><![CDATA[participant user as u
participant service A as a
participant service B as b

note over a,b: pre-shares a (public) key
u->a: token request
a->a: sign token
a->u: token
u->b: authorized request
b->b: verify token
b->u: response]]></source><desc></desc><defs><marker viewBox="0 0 5 5" markerWidth="5" markerHeight="5" orient="auto" refX="5" refY="2.5" id="markerArrowBlock"><path d="M 0 0 L 5 2.5 L 0 5 z"></path></marker><marker viewBox="0 0 9.6 16" markerWidth="4" markerHeight="16" orient="auto" refX="9.6" refY="8" id="markerArrowOpen"><path d="M 9.6,8 1.92,16 0,13.7 5.76,8 0,2.286 1.92,0 9.6,8 z"></path></marker></defs><g class="title"></g><g class="actor"><rect x="10" y="20" width="58.53333282470703" height="39" style="stroke-width: 2px;" stroke="#000000" fill="#ffffff"></rect><text x="20" y="45" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="20">user</tspan></text></g><g class="actor"><rect x="10" y="362" width="58.53333282470703" height="39" style="stroke-width: 2px;" stroke="#000000" fill="#ffffff"></rect><text x="20" y="387" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="20">user</tspan></text></g><line x1="39.266666412353516" x2="39.266666412353516" y1="59" y2="362" style="stroke-width: 2px;" stroke="#000000" fill="none"></line><g class="actor"><rect x="131.14999771118164" y="20" width="106.69999694824219" height="39" style="stroke-width: 2px;" stroke="#000000" fill="#ffffff"></rect><text x="141.14999771118164" y="45" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="141.14999771118164">service A</tspan></text></g><g class="actor"><rect x="131.14999771118164" y="362" width="106.69999694824219" height="39" style="stroke-width: 2px;" stroke="#000000" fill="#ffffff"></rect><text x="141.14999771118164" y="387" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="141.14999771118164">service A</tspan></text></g><line x1="184.49999618530273" x2="184.49999618530273" y1="59" y2="362" style="stroke-width: 2px;" stroke="#000000" fill="none"></line><g class="actor"><rect x="361.98332595825195" y="20" width="106.69999694824219" height="39" style="stroke-width: 2px;" stroke="#000000" fill="#ffffff"></rect><text x="371.98332595825195" y="45" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="371.98332595825195">service B</tspan></text></g><g class="actor"><rect x="361.98332595825195" y="362" width="106.69999694824219" height="39" style="stroke-width: 2px;" stroke="#000000" fill="#ffffff"></rect><text x="371.98332595825195" y="387" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="371.98332595825195">service B</tspan></text></g><line x1="415.33332443237305" x2="415.33332443237305" y1="59" y2="362" style="stroke-width: 2px;" stroke="#000000" fill="none"></line><g class="note"><rect x="174.49999618530273" y="79" width="250.8333282470703" height="29" style="stroke-width: 2px;" stroke="#000000" fill="#ffffff"></rect><text x="179.49999618530273" y="99" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="179.49999618530273">pre-shares a (public) key</tspan></text></g><g class="signal"><text x="49.266666412353516" y="138.5" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="49.266666412353516">token request</tspan></text><line x1="39.266666412353516" x2="184.49999618530273" y1="147" y2="147" style="stroke-width: 2px; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="signal"><text x="209.49999618530273" y="181.5" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="209.49999618530273">sign token</tspan></text><line x1="184.49999618530273" x2="204.49999618530273" y1="167" y2="167" style="stroke-width: 2px;" stroke="#000000" fill="none"></line><line x1="204.49999618530273" x2="204.49999618530273" y1="167" y2="191" style="stroke-width: 2px;" stroke="#000000" fill="none"></line><line x1="204.49999618530273" x2="184.49999618530273" y1="191" y2="191" style="stroke-width: 2px; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="signal"><text x="87.79999732971191" y="216.5" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="87.79999732971191">token</tspan></text><line x1="184.49999618530273" x2="39.266666412353516" y1="225" y2="225" style="stroke-width: 2px; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="signal"><text x="140.5999984741211" y="255.5" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="140.5999984741211">authorized request</tspan></text><line x1="39.266666412353516" x2="415.33332443237305" y1="264" y2="264" style="stroke-width: 2px; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="signal"><text x="440.33332443237305" y="298.5" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="440.33332443237305">verify token</tspan></text><line x1="415.33332443237305" x2="435.33332443237305" y1="284" y2="284" style="stroke-width: 2px;" stroke="#000000" fill="none"></line><line x1="435.33332443237305" x2="435.33332443237305" y1="284" y2="308" style="stroke-width: 2px;" stroke="#000000" fill="none"></line><line x1="435.33332443237305" x2="415.33332443237305" y1="308" y2="308" style="stroke-width: 2px; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g><g class="signal"><text x="188.76666259765625" y="333.5" style="font-size: 16px; font-family: Andale Mono, monospace;"><tspan x="188.76666259765625">response</tspan></text><line x1="415.33332443237305" x2="39.266666412353516" y1="342" y2="342" style="stroke-width: 2px; marker-end: url(&quot;#markerArrowBlock&quot;);" stroke="#000000" fill="none"></line></g></svg>